---
title: "Jacksonì˜ objectMapper, ì§ë ¬í™”, ì—­ì§ë ¬í™” ì´í•´í•˜ê¸°"
date: 
categories: [Spring íƒêµ¬]
tags: [Jackson, ì§ë ¬í™”, ì—­ì§ë ¬í™”, objectMapper, Jackson2ObjectMapperBuilder]
---


Jacksonì´ ë¬´ì—‡ì¸ì§€ì— ëŒ€í•´ ì•Œì•„ë´…ì‹œë‹¤.

ìë°”, ì½”í‹€ë¦°ì„ ì´ìš©í•´ ì›¹ ì„œë²„ ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ê°ì²´ë¥¼ JSON í˜•íƒœë¡œ ë³€í™˜í•˜ì—¬
ì‘ë‹µì„ ì œê³µí•˜ê³¤ í•©ë‹ˆë‹¤.

ì´ë•Œ, ê°ì²´ë¥¼ JSON í˜•íƒœë¡œ ë³€í™˜í•´ì£¼ê³ , JSONì„ ë˜ ë‹¤ì‹œ ê°ì²´ë¡œ ë°”ê¿”ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€
Jackson ì…ë‹ˆë‹¤. 


MSA ì•„í‚¤í…ì²˜ë¥¼ êµ¬í˜„í•˜ëŠ” ì„œë¹„ìŠ¤ì—ì„œëŠ” ì—¬ëŸ¬ ì„œë²„ê°„ apië¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. 
ê°„í˜¹ ì„œë²„ê°„ api í˜¸ì¶œ ì‹œì— JSON íŒŒì‹± ë“±ì˜ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
// Caller
{
    localTime: "null"
}

// Callee ìª½ì—ì„œ JSONParseException ! 
```

ì´ëŸ° ë¬¸ì œë“±ì„ ì´í•´í•˜ê¸° ìœ„í•´ Jacksonì˜ objectMapperì™€ ì§ë ¬í™”, ì—­ì§ë ¬í™”ê°€ ì–´ë–»ê²Œ ì´ë¤„ì§€ëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤.



### Jackson

> ğŸ‘‰ Jackson = Java/Kotlin ê°ì²´ â†” JSON ë¬¸ìì—´ì„ ë³€í™˜í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬  
> Object -> Json : ì§ë ¬í™” (LocalDateTime -> "2025-12-03T10:00:00")  
> Json -> Object : ì—­ì§ë ¬í™” ("2025-12-03T10:00:00" -> LocalDateTime)  


- ì—­ì§ë ¬í™” (JSON -> ê°ì²´)
```
JSON String
  â†“
JsonParser (í† í°í™”)
  â†“
Deserializer ì„ íƒ (íƒ€ì… ê¸°ë°˜)
  â†“
BeanDeserializer / StdDeserializer
  â†“
ê°ì²´ ìƒì„± + í•„ë“œ ì„¸íŒ…
```

- ì§ë ¬í™”(ê°ì²´ â†’ JSON)  
```
Java Object
  â†“
Serializer ì„ íƒ
  â†“
BeanSerializer / StdSerializer
  â†“
JsonGenerator (ë¬¸ìì—´ ìƒì„±)
```

ğŸ‘‰ ObjectMapperëŠ” ì´ â€œì„ íƒâ€ì„ ë‹´ë‹¹


- objectMapper 
  - ì„¤ì •ì´ ì–´ë–»ê²Œ ê²°ê³¼ë¥¼ ë°”ê¾¸ëŠ”ì§€
  - readValue
  - writeValueAsString
  - ë‚´ìš© ë„£ê¸°


- JacksonConfiguration

### ì§ë ¬í™” 
ì§ë ¬í™” ê³¼ì •ì—ì„œ ë””ë²„ê¹…ì„ í•´ë³´ë©´
objectMapperì— ë“±ë¡ëœ writeValueAsStringì´ ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•œë‹¤

Input
```kotlin
val dto = TestDto(
    id = 1L,
    name = "í…ŒìŠ¤íŠ¸",
    email = "test@example.com",
    createdAt = LocalDateTime.now(),
    tags = listOf("tag1", "tag2"),
    status = Status.ACTIVE,
    metadata = mapOf("key" to "value")
)

// When: ì§ë ¬í™” (Object -> JSON)
val json = objectMapper.writeValueAsString(dto)
```

objectMapper ë‚´ë¶€ ì½”ë“œ
```java
public String writeValueAsString(Object value)
    throws JsonProcessingException
{
    // alas, we have to pull the recycler directly here...
    final BufferRecycler br = _jsonFactory._getBufferRecycler();
    try (SegmentedStringWriter sw = new SegmentedStringWriter(br)) {
        _writeValueAndClose(createGenerator(sw), value);
        return sw.getAndClear();
    } catch (JsonProcessingException e) {
        throw e;
    } catch (IOException e) { // shouldn't really happen, but is declared as possibility so:
        throw JsonMappingException.fromUnexpectedIOE(e);
    } finally {
        br.releaseToPool(); // since 2.17
    }
}
```

valueë¥¼ ë°›ì•„ì„œ, StringWriterê°€ String í˜•íƒœë¡œ ë³€í™˜í•´ì¤€ë‹¤
ë³€í™˜ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤
```json
{
  "id" : 1,
  "name" : "í…ŒìŠ¤íŠ¸",
  "email" : "test@example.com",
  "createdAt" : "2025-12-13T17:39:29.174732",
  "tags" : [ "tag1", "tag2" ],
  "status" : "ACTIVE",
  "metadata" : {
    "key" : "value"
  }
}
```



### ì—­ì§ë ¬í™” 
ì—­ì§ë ¬í™”ë¥¼ í• ë•ŒëŠ” ObjectMapper.readValue()ë¥¼ overrideí•œ inline fun ì´ ì‹¤í–‰ëœë‹¤  
ì´ë•Œ, ì‚¬ìš©ìê°€ ì„¤ì •í•œ ì»¤ìŠ¤í…€ Deserializerê°€ ìˆë‹¤ë©´ ìš°ì„  ì ìš©ë˜ë©°  
ë‹¤ìŒìœ¼ë¡œ Annotation, ë“±ë¡ëœ Module, ê¸°ë³¸ Deserializerê°€ ì‚¬ìš©ëœë‹¤
```
ObjectMapper.readValue
 â†“
ObjectMapper._readMapAndClose
 â†“
DeserializationContext ìƒì„±
 â†“
DeserializerFactory í˜¸ì¶œ
 â†“
1. @JsonDeserialize ìˆëŠ”ì§€?
2. Moduleì— ë“±ë¡ëœ Deserializer ìˆëŠ”ì§€?
3. ê¸°ë³¸ íƒ€ì… ì²˜ë¦¬ ê°€ëŠ¥í•œì§€?
 â†“
ì„ íƒëœ Deserializer ì‹¤í–‰
```


```java
protected Object _readMapAndClose(JsonParser p0, JavaType valueType)
        throws IOException
{
    try (JsonParser p = p0) {
        final Object result;
        final DeserializationConfig cfg = getDeserializationConfig();
        final DefaultDeserializationContext ctxt = createDeserializationContext(p, cfg);
        ...
        if (t == JsonToken.VALUE_NULL) {
            // Ask JsonDeserializer what 'null value' to use:
            result = _findRootDeserializer(ctxt, valueType).getNullValue(ctxt);
        } else if (t == JsonToken.END_ARRAY || t == JsonToken.END_OBJECT) {
            result = null;
        } else if (t == JsonToken.NOT_AVAILABLE) {
            // 28-Jan-2025, tatu: [databind#4932] Need to handle this case too
            result = null;
        } else {
            result = ctxt.readRootValue(p, valueType,
                    _findRootDeserializer(ctxt, valueType), null); // ì´ ìœ„ì¹˜ì—ì„œ ìš°ì„ ìˆœìœ„ì— ë”°ë¥¸ ì—­ì§ë ¬í™”ë¥¼ ì°¾ëŠ”ë‹¤ 
            ctxt.checkUnresolvedObjectId();
        }
        if (cfg.isEnabled(DeserializationFeature.FAIL_ON_TRAILING_TOKENS)) {
            _verifyNoTrailingTokens(p, ctxt, valueType);
        }
        return result;
    }
}

```

ê²°ê³¼
```
// Json
{
  "type" : "test",
  "version" : 1,
  "items" : [ "item1", "item2", "item3" ],
  "metadata" : {
    "key1" : "value1",
    "key2" : "value2"
  },
  "optionalField" : "optional"
}

// ê°ì²´
ComplexObject(type=test, version=1, items=[item1, item2, item3], metadata={key1=value1, key2=value2}, optionalField=optional)

```
Jsonìœ¼ë¡œë¶€í„° ê°ì²´ì˜ í•„ë“œë¥¼ ìƒì„±í• ë•Œ Jacksonì˜ ìƒì„±ìì˜ ìœ ë¬´ë¥¼ í†µí•´ì„œ ì—­ì§ë ¬í™”ë¥¼ í•œë‹¤.  
ê¸°ë³¸ ìƒì„±ìë¥¼ í†µí•´ í˜¸ì¶œí•˜ì—¬ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  setterë¥¼ í†µí•´ í•„ë“œë¥¼ ì´ˆê¸°í™”í•˜ê³ ,  
í•´ë‹¹ í•„ë“œì˜ getter, setterê°€ ì¡´ì¬í•œë‹¤ë©´ ì´ë¥¼ í†µí•´ í•„ë“œë¥¼ ì¶”ë¡ í•˜ê²Œëœë‹¤.  

ì›ë˜ë¼ë©´ í•„ë“œì— @JsonCreater, @JsonPropertyì™€ ê°™ì€ ì–´ë…¸í…Œì´ì…˜ì´ ì—†ë‹¤ë©´ ì—­ì§ë ¬í™”ê°€ ì‹¤íŒ¨í•˜ì§€ë§Œ
Kotlinì—ì„œëŠ” kotlinModuleì„ ì¶”ê°€í•œ extension ë•ë¶„ì—, ë¶€ê°€ ì–´ë…¸í…Œì´ì…˜ ì—†ì´ë„  
data classì— ëŒ€í•´ì„œ ì—­ì§ë ¬í™”ë¥¼ ì„±ê³µí•  ìˆ˜ ìˆë‹¤.  

ì•„ë˜ ì½”ë“œëŠ” Springì—ì„œ Jackson2ObjectMapperBuilder.configure() ë©”ì†Œë“œ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë˜ëŠ”  
`registerWellKnownModulesIfAvailable` í•¨ìˆ˜ì´ë‹¤.  
ì´ë•Œ, objectMapperë¥¼ ì •ì˜í•   ì½”í‹€ë¦° í™˜ê²½ì¸ ê²½ìš° kotlin ëª¨ë“ˆì„ ë“±ë¡í•˜ê³  objectMapperì— ì ìš©ëœë‹¤.  
ë”°ë¼ì„œ data classì˜ ê²½ìš° ë³„ë„ì˜ `@JsonProperty`ì™€ ê°™ì€ ì–´ë…¸í…Œì´ì…˜ ì—†ì´ë„ ì—­ì§ë ¬í™”ê°€ ì´ë£¨ì–´ì§„ë‹¤.  

```java
private void registerWellKnownModulesIfAvailable(MultiValueMap<Object, Module> modulesToRegister) {
    ...

    // Kotlin present?
    if (KotlinDetector.isKotlinPresent()) {
        try {
            Class<? extends Module> kotlinModuleClass = (Class<? extends Module>)
                    ClassUtils.forName("com.fasterxml.jackson.module.kotlin.KotlinModule", this.moduleClassLoader);
            Module kotlinModule = BeanUtils.instantiateClass(kotlinModuleClass);
            modulesToRegister.set(kotlinModule.getTypeId(), kotlinModule);
        }
        catch (ClassNotFoundException ex) {
            // jackson-module-kotlin not available
        }
    }
}

```

### Jacksonì—ì„œ í™œìš©í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ ì¢…ë¥˜


```kotlin

data class AnnotationExampleDto(
    // í•„ë“œëª…ì„ ë‹¤ë¥´ê²Œ ë§¤í•‘
    @JsonProperty("user_id")
    val userId: Long,

    // ì§ë ¬í™”ì—ì„œ ì œì™¸ (JSONì— í¬í•¨ ì•ˆ ë¨)
    @JsonIgnore
    val password: String,

    // ì—­ì§ë ¬í™”ë§Œ í—ˆìš© (JSON â†’ Objectë§Œ ê°€ëŠ¥, Object â†’ JSON ë¶ˆê°€)
    @JsonProperty(access = JsonProperty.Access.WRITE_ONLY)
    val secretKey: String,

    // ì§ë ¬í™”ë§Œ í—ˆìš© (Object â†’ JSONë§Œ ê°€ëŠ¥)
    @JsonProperty(access = JsonProperty.Access.READ_ONLY)
    val createdAt: LocalDateTime = LocalDateTime.now(),

    // ë³„ì¹­ í—ˆìš© (JSONì—ì„œ "email" ë˜ëŠ” "mail" ë‘˜ ë‹¤ ë°›ì„ ìˆ˜ ìˆìŒ)
    @JsonAlias("mail", "e-mail")
    val email: String,

    // ê¸°ë³¸ê°’ ì„¤ì • (JSONì— ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©)
    @JsonSetter(nulls = Nulls.SKIP)  // nullì´ë©´ ê¸°ë³¸ê°’ ìœ ì§€
    val status: String = "ACTIVE",

    // ì¤‘ì²© ê°ì²´ í’€ê¸°/ê°ì‹¸ê¸°
    @JsonUnwrapped
    val address: Address? = null,

    // ëª¨ë“  ì¶”ê°€ ì†ì„±ì„ Mapìœ¼ë¡œ ë°›ê¸°
    @JsonAnySetter
    @get:JsonAnyGetter
    val additionalProperties: MutableMap<String, Any> = mutableMapOf()
)
```

- `@JsonProperty` 
  - Jsonì—ì„œ í•„ë“œë¥¼ ë‹¤ë¥´ê²Œ ëª…ì‹œí•  ìˆ˜ ìˆë‹¤. (value)
  - ì—­ì§ë ¬í™”ë‚˜, ì§ë ¬í™”ë§Œ í—ˆìš©í•  ìˆ˜ ìˆë‹¤ (Access)
- `@JsonIgnore`
  - Json í•„ë“œì—ì„œ ì œì™¸ëœë‹¤
- `@JsonAlias`
  - ë³„ì¹­ì„ ì¶”ê°€í•˜ì—¬, ë‘ê°€ì§€ ë°©ì‹ì„ ëª¨ë‘ ë°›ì„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤
- `@JsonSetter`
  - Json í•„ë“œì˜ ê¸°ë³¸ê°’ì„ ì„¤ì •í•´ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜
  - Jackson ì—­ì§ë ¬í™” ê³¼ì •ì—ì„œ í•„ë“œê°’ì´ ì…‹íŒ…ë ë•Œ ê°’ì„ ì£¼ì…í•œë‹¤
- `@JsonCreater`
  - ì—­ì§ë ¬í™” ì‹œì— ìƒì„±ìë¡œ ì‚¬ìš©í•˜ê²Œë” ëª…ì‹œí•œë‹¤
  - ì´ë–„ ë‚´ë¶€ì˜ JsonPropertyëŠ” JSON í•„ë“œ -> íŒŒë¼ë¯¸í„°ë¡œ ë§¤ì¹­ì‹œì¼œì£¼ëŠ” ì—­í• 

- `@JsonInclue`
```kotlin
@JsonInclude(JsonInclude.Include.NON_NULL)  // null í•„ë“œ ì œì™¸
data class ConditionalDto(
    val id: Long,
    val name: String,
    val email: String? = null,  // nullì´ë©´ JSONì—ì„œ ì œì™¸

    @JsonInclude(JsonInclude.Include.NON_EMPTY)  // ë¹ˆ ì»¬ë ‰ì…˜ë„ ì œì™¸
    val tags: List<String> = emptyList(),

    @JsonInclude(JsonInclude.Include.ALWAYS)  // í•­ìƒ í¬í•¨ (í´ë˜ìŠ¤ ì„¤ì • ì˜¤ë²„ë¼ì´ë“œ)
    val status: String? = null
)
```

### LocalDate íƒ€ì…ì—ì„œ "null" ë¡œ íŒŒì‹±ë˜ëŠ” ì˜¤ë¥˜
```json
{
  "localTime": "null"
}
```

ì‚¬ì‹¤ ì´ê±´ Jackson ìì²´ì˜ ë¬¸ì œë¼ê¹ë¤, DTO -> Jsonìœ¼ë¡œ ë³€í™˜í• ë•Œ ìƒê¸°ëŠ” ì˜¤ë¥˜ì´ë‹¤.  
```
data class RequestDto(
    val localTime: String?
)
```
```
RequestDto(localTime=null)
```

ì´ê²ƒì„ toString / Map ë³€í™˜ / String ìºìŠ¤íŒ… ê³¼ ê°™ì€ ê°€ê³µì„ ì˜ëª»í•˜ê²Œë˜ë©´  
Jsonì—ì„œ nullì´ ë¬¸ìì—´ë¡œ ë“¤ì–´ê°€ê²Œ ëœë‹¤. 
```
map["localTime"] = dto.localTime.toString()

{
    "localTime": "null"
}
```

### Claudeê°€ ì•Œë ¤ì£¼ëŠ” Jackson íŠ¸ëŸ¬ë¸”ìŠˆíŒ… íŒ
  ===== Jackson ë””ë²„ê¹… ì²´í¬ë¦¬ìŠ¤íŠ¸ =====
 
  1. ì§ë ¬í™” ì•ˆ ë˜ëŠ” ê²½ìš°:
     - getterê°€ ìˆëŠ”ì§€ í™•ì¸ (Kotlinì€ val/varë¡œ ìë™ ìƒì„±)
     - @JsonIgnoreê°€ ë¶™ì–´ìˆì§€ ì•Šì€ì§€ í™•ì¸
     - SerializationFeature.FAIL_ON_EMPTY_BEANS ì„¤ì • í™•ì¸
 
  2. ì—­ì§ë ¬í™” ì•ˆ ë˜ëŠ” ê²½ìš°:
     - ê¸°ë³¸ ìƒì„±ìê°€ ìˆëŠ”ì§€ í™•ì¸ (data classëŠ” ìë™)
     - í•„ë“œëª…ì´ JSON í‚¤ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
     - @JsonPropertyë¡œ ë§¤í•‘ í™•ì¸
     - DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES ì„¤ì • í™•ì¸
 
  3. ë‚ ì§œ/ì‹œê°„ ë¬¸ì œ:
     - JavaTimeModule ë“±ë¡ í™•ì¸
     - @JsonFormatìœ¼ë¡œ í¬ë§· ì§€ì •
     - WRITE_DATES_AS_TIMESTAMPS ì„¤ì • í™•ì¸
 
  4. null ì²˜ë¦¬:
     - KotlinModuleì˜ NullToEmptyCollection ë“± ì„¤ì • í™•ì¸
     - nullable íƒ€ì… (String?) vs non-null íƒ€ì… (String) êµ¬ë¶„
     - @JsonInclude ì„¤ì • í™•ì¸
